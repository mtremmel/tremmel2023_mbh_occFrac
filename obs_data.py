# Data from Miller+ 2015 fig 2 via webplot digitizer https://iopscience.iop.org/article/10.1088/0004-637X/799/1/98/pdf
import numpy as np

M15_est = {
	'logMstar_high': np.array([
7.541734346695544,7.574488138448273,7.612295372357138,7.680396521413628,7.723283935267813,7.783845027773879,
7.834259129283896,7.856946143408133,7.892199918449744,7.932480397858304,7.975220753871967,8.027961043041156,8.093201248654756,8.168401280740103,
8.233507797407771,8.298600945180848,8.376153902714556,8.463706793403787,8.583732729059298,8.711245245686861, 9,9.5,10,10.5,11,11.5,12]),
	'occfrac_high': np.array([
0.27376020213768626, 0.31436688257431444, 0.3635243079925937, 0.45970815703103596, 0.5216943737007106,
		0.6114691746712924, 0.6777254162739554, 0.7076476761518973, 0.7482516828096069, 0.7931283881792234, 0.831585350365305,
		0.8700316174357123,0.9084645156115266, 0.9404696492670503, 0.9575123160941437, 0.972415959786365, 0.9808891651793771,
		0.9893516754567148, 0.9935013803383667, 0.9955040407483906,1.0,1.0,1.0,1.0,1.0,1.0,1.0]),

	'logMstar_low': np.array([
7.8552081871110495,7.932761144644756,8.007800749994987, 8.082867093134404,8.175446688190588, 8.248026416935716,8.323132866758913,
8.405752635343347,8.473372504194492,8.546019077412584,8.613679052947507,8.671325726432311,8.739025808651013,8.796685851030407,
8.84685931243775,8.914599501340232,8.964772962747576,9.055119952406736,9.120373526914928,9.195680510157018,
9.306120948389383,9.376387858369931,9.44162806398353, 9.511881605069485, 9.582108408366254,
9.687415191074926, 9.747575216743204,9.84528846732308,9.92294837601353,10.023108134303916,10.100714567415993,10.180807614922362,
10.23336073956725, 10.293413814078784, 10.365966805034727, 10.426006510651668, 10.496046149424135, 10.558572469435365,10.648611974518888,
10.761151329202345, 10.98618993188548, 10.873670630543913, 11.101202532068637,11.206215199096263,11.348727615457117, 11.5, 12
	]),

	'occfrac_low': np.array([
		0.0295746686185254246, 0.03804787401153731, 0.04438473004859589, 0.05499963235539862, 0.06773484134464347,
		0.08049144056523683, 0.09752341227665584, 0.11668638578619128, 0.13586540196923802, 0.15931711686419192, 0.18491320245185527, 0.2083809600203207, 0.2403941150126001,
		0.26600089571593766, 0.29375472089090304, 0.33218494528779874, 0.3599387704627641, 0.4154571159283693, 0.45602903723905575,
		0.5051463559735563, 0.5756164731519173, 0.6183220700396386, 0.656754968215453, 0.6973215419683022, 0.7336100694514072,
		0.7826953028388846, 0.8082994097633035, 0.842419502543432, 0.8680048930154208, 0.8935662194771423, 0.9105955174096427,
		0.9254831184283525, 0.9339830616105504, 0.9424749834559927, 0.950953536406842, 0.9573064351174121,
		0.963648638712307, 0.9678598405090872, 0.9741806538726343, 0.980477403225914, 0.9866538325278571,
		0.9835656178768856, 0.9886698618324741, 0.9906965862527654, 0.9926832039892778, 1.0, 1.0
		])
}

Nils21_nsc_frac = {'nsc_frac_LV':np.array([
					0.00, 0.00,0.05009198467484688,0.00,0.08122837516245007,0.13033637698526546,0.14237033536430999,
0.30977569241674974,0.3624145555199243,0.6145470809633918,0.8366807878613985,0.5274063697277592,
0.685088355921619,0.24429610626339682]),
					'logMstar':np.array([3.5,5.0,5.5,6, 6.5,7.0,
						7.50, 8, 8.50, 9.0, 9.5, 10, 10.5, 11]),
					'ngal':np.array([9, 16, 19, 49, 70, 98, 95, 69, 57, 42, 25, 15, 13, 8])
}

C22_nsc_frac = {'nsc_frac_LV': np.array([
					0.0,
					0.15576559546313806,
					0.20113421550094523,
					0.13308128544423448,
					0.5311909262759925,
					0.4438563327032138
				]),
				'logMstar': np.array([
					5.750000000000001,
					6.250000000000001,
					6.750000000000001,
					7.25,
					7.750000000000001,
					8.250000000000002
				]),
				'nsc_frac_LV_high': np.array([
					0.0,
					0.21020793950850658,
					0.2646502835538752,
					0.19773156899810962,
					0.6196597353497164,
					0.60945179584121
				]),
				'nsc_frac_LV_low': np.array([
					0.0,
					0.10018903591682415,
					0.13648393194706998,
					0.07183364839319473,
					0.44045368620037817,
					0.27826086956521745
				])
}

from scipy.interpolate import interp1d
M15_of_func_high = interp1d(M15_est['logMstar_high'], M15_est['occfrac_high'])
M15_of_func_low = interp1d(M15_est['logMstar_low'], M15_est['occfrac_low'])

M15_data = {'logMstar': np.array(
	[8.929528953599874, 9.717254740797275, 10.24235307931662, 10.734221804731991, 11.262594832253729]),
			'frac': np.array(
				[0.06375597695975799, 0.34792592157706936, 0.676675994964024, 0.8068938074456773, 0.7610194589587531]),
			'frac_max': np.array(
				[0.08614389061755923, 0.47031318290638424, 0.8169761965335264, 0.9665942582046615, 0.9326601303352315]),
			'frac_min': np.array(
				[0.03390542541602237, 0.23001624297931444, 0.5393660671767877, 0.6516709394182536, 0.5923638427366482]),
			'logMstar_min': np.array(
				[7.600866292230115, 9.507452852958636, 9.997586384599828, 10.503441032766458, 10.996849253410048]),
			'logMstar_max': np.array(
				[9.49595882502593, 9.993463668564942, 10.48709368089395, 10.992948329060582, 11.993346249437366])
}

#From Greene 2020 empirical model
G12_data = {
	'logMstar': np.array([9.5, 8.5, 7.5]),
	'D09_occ_frac_1e6': np.array([0.5890957446808511, 0.3497340425531915, 0.0]),
	'G10_occ_frac_1e6': np.array([0.47207446808510645, 0.2340425531914896, 0.0]),
	'D09_occ_frac_3e5': np.array([0.875, 0.5252659574468086, 0.0]),
	'G10_occ_frac_3e5': np.array([0.6648936170212766, 0.3297872340425533, 0.0])
}

#Gallo+ 2010 for Virgo cluster
G10_data = {
	'logMstar': np.array([11.25233644859813, 10, 9]),
	'logMstar_min': np.array([10.501557632398754, 9.504672897196262, 8.501557632398754]),
	'logMstar_max': np.array([11.996884735202492, 10.498442367601246, 9.495327102803738]),
	'frac': np.array([0.6946448598130842, 0.29189719626168253, 0.07289719626168234]),
	'frac_max': np.array([0.8626448598130843, 0.42389719626168243, 0.13689719626168262]),
	'frac_min': np.array([0.5266448598130842, 0.1618971962616822, 0.0])
}

# dwarf galaxy data from Birchall+ 2020 https://arxiv.org/pdf/2001.03135.pdf
B20_data = {
	'logMstar': np.array([7.4023769100169785, 8.633276740237692, 9.285229202037353]),
	'frac_39': np.array([2.6584265755722383 / 100., 3.0485916501319386 / 100, 5.641059995499829 / 100]),
	'frac_40p5': np.array([0.45359707079591693 / 100., 0.5124470718186842 / 100., 1.1771943461451917 / 100.]),
	'frac_39_upper': np.array([3.7325581395348815 / 100., 3.9186046511627852 / 100., 7.65116279069767 / 100.]),
	'frac_40p5_upper': np.array([0.45359707079591693 / 100., 0.6976744186046453 / 100., 1.4186046511627826 / 100.])
}
B20_data['frac_39_err'] = B20_data['frac_39_upper'] - B20_data['frac_39']
B20_data['frac_40p5_err'] = B20_data['frac_40p5_upper'] - B20_data['frac_40p5']

nsc_frac_SJ19 = {'logmstar': [4.948827292110874,  # presented in Sanchez-Janssen 2019
                              5.447761194029851,
                              5.946695095948827,
                              6.452025586353941,
                              6.944562899786783,
                              7.449893390191899,
                              7.948827292110874,
                              8.447761194029852,
                              8.953091684434968],
                 'nsc_frac_virgo': [0.0,
                                    0.015839493136219573,
                                    0.11214361140443496,
                                    0.18563885955649395,
                                    0.3055966209081309,
                                    0.4078141499472018,
                                    0.7203801478352696,
                                    0.7651531151003166,
                                    0.8893347412882788],
                 'nsc_frac_virgo_upper': [0.12228088701161544,
                                          0.05638859556494147,
                                          0.15945089757127695,
                                          0.23548046462513472,
                                          0.36810982048574814,
                                          0.4779303062301967,
                                          0.7904963041182649,
                                          0.8352692713833139,
                                          0.9281942977824711],
                 'nsc_frac_virgo_lower': [0.0,
                                          0.010770855332626006,
                                          0.07919746568109254,
                                          0.14677930306229925,
                                          0.25153115100316437,
                                          0.3419218585005277,
                                          0.6139387539598792,
                                          0.6367476240760361,
                                          0.705174234424503]
                 }

nsc_frac_M15 = {'logmstar': [4.955223880597014,  # presented in Sanchez-Janssen 2019, from Munoz 2015
                             5.447761194029851,
                             5.953091684434969,
                             6.452025586353943,
                             6.950959488272922,
                             7.456289978678042,
                             7.955223880597017,
                             8.460554371002134,
                             8.95309168443497],
                'nsc_frac_fornax': [0.0,
                                    0.0,
                                    0.051319957761351453,
                                    0.28532206969376983,
                                    0.34023231256599773,
                                    0.4610348468848997,
                                    0.6426610348468845,
                                    0.7499472016895457,
                                    1],
                'nsc_frac_fornax_lower': [0.0,
                                          0.0,
                                          0.0378035902851106,
                                          0.2270327349524779,
                                          0.2768743400211152,
                                          0.3714889123548093,
                                          0.5032734952481589,
                                          0.5539598732840647,
                                          0.6299894403379173],
                'nsc_frac_fornax_upper': [0.09947201689546548,
                                          0.04118268215417098,
                                          0.1003167898627273,
                                          0.35797254487856844,
                                          0.4154171066525866,
                                          0.5607180570221701,
                                          0.749102428722275,
                                          0.8479408658922887,
                                          1.0]
                }